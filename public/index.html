<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Sense360 API Reference</title>

  <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
  <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />

  <link href="stylesheets/main.css" rel="stylesheet" type="text/css" media="screen"/>
  <link href="stylesheets/slate_custom.css" rel="stylesheet" type="text/css" media="screen"/>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>

    <script>
      $(function () {
        setupLanguages(["swift","objective_c"]);
      });
    </script>

  <script type="text/javascript">

    $(function () {
      var $sidebar = $(".tocify-wrapper"),
          $window = $(window),
          offset = $sidebar.offset(),
          topPadding = 15;

      $window.scroll(function () {
        if ($window.scrollTop() > offset.top) {
          $sidebar.stop().animate({
            marginTop: $window.scrollTop() - offset.top + topPadding
          });
        } else {
          $sidebar.stop().animate({
            marginTop: 0
          });
        }
      });

    });

    $(function () {
      var $sidebar = $("#nav-button"),
          $window = $(window),
          offset = $sidebar.offset(),
          topPadding = 15;

      $window.scroll(function () {
        if ($window.scrollTop() > offset.top) {
          $sidebar.stop().animate({
            marginTop: $window.scrollTop() - offset.top + topPadding
          });
        } else {
          $sidebar.stop().animate({
            marginTop: 0
          });
        }
      });

    });
  </script>
</head>

<body class="main index">

<div class="header">
  <div class="header-inner">
    <div class="menu-box">
      <a href="index.html" class="logo-blue"><img src="img/logo_blue.png"></a>
      <a href="sign_up.html" class="register">REGISTER</a>

      <div class="menu-nav">
        <ul>
          <li><a href="#">Ideas</a></li>
          <li><a href="faq.html">Faq</a></li>
          <li><a href="about_us.html">Company</a></li>
          <li><a href="getting_started.html">Quick Start</a></li>
          <li><a href=" http://sense-ios-docs.herokuapp.com/index.html">Docs</a></li>
          <li><a href="#">Blog</a></li>
          <li><a href="support.html">Support</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="topTitle">
    <div class="topTitle-box">
      <ul>
        <li class="documentation"><a href="http://sense360docs.com">Quick Start</a></li>
        <li class="get-key"><a href="sign_up.html" onclick="registerMainHomeButton()">Request API Key</a></li>
      </ul>
    </div>
  </div>
</div>


<div class="getting-box">

  <a href="#" id="nav-button" style="position:absolute; float: left;">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
  </a>

  <div class="tocify-wrapper">
      <div class="search">
        <input type="text" class="search" id="input-search" placeholder="Search">
      </div>
      <ul class="search-results"></ul>


    <div class="getting-tab tabSwift active">
      <div id="toc">
      </div>
    </div>

      <ul class="toc-footer">
          <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
      </ul>
  </div>


  <div class="page-wrapper">
    <div class="content">
      <h1 id="introduction">Introduction</h1>

<p>Sense360 allows you to quickly build functions around actions that your users take in the physical world. You can build triggers based on where a user is, what they are doing, or what is happening around them. <strong>You can do all this in the background, even if your app is closed.</strong> Adding these real-world triggers to your app can take months if you try to achieve high accuracy, low battery drain, and maximum user privacy. We make the process quick and painless.</p>

<p>Eventually, we aim to have a trigger for any action a user can take, whether it be &ldquo;running&rdquo;, &ldquo;driving&rdquo;, &ldquo;waking up&rdquo;, &ldquo;eating&rdquo;, &ldquo;watching tv&rdquo;, &ldquo;playing basketball&rdquo;, &ldquo;watching basketball&rdquo;, etc.</p>

<p><strong>Sign up for a developer key</strong> by clicking the green link on the left. </p>

<p>Have fun creating!</p>

<h1 id="template-project">Template Project</h1>

<p>Swift and Objective-C projects are available at <a href='https://github.com/Sense360/Sense360IOSStarter'>https://github.com/Sense360/Sense360IOSStarter</a>.</p>

<h1 id="download">Download</h1>

<p>You can download the stand alone framework <a href='https://www.dropbox.com/s/few391levfy93aj/SenseSdk.framework.zip?dl=0'>here</a>.</p>

<h1 id="api-components">API Components</h1>

<p>The following are the main components of building with Sense360</p>

<p><a href="#triggers">Triggers</a>: The real-world event that you want to listen for (can be a place, action, or contextual element). Example triggers are “has arrived at airport”, “has exited work”, or “is 100 miles from home”</p>

<p><a href="#recipes">Recipes</a>:  A collection of elements (including the Trigger) that defines <strong>when</strong> you want to listen for the trigger, and <strong>what</strong> you want to happen when the trigger is fired. Recipes gives you the flexibility to do whatever you want upon a Trigger event and are constructed of the following:</p>

<ul>
<li><p><strong>Unique Id (required)</strong>: A unique identifier amongst all recipes within your app. Examples: &ldquo;ID-1234&rdquo; or &ldquo;EnteredWork&rdquo;.</p></li>
<li><p><strong>Delegate (required)</strong>: The method that is called when the trigger is fired.</p></li>
<li><p><strong>Trigger (required)</strong>: The real-world event that you want to listen for.</p></li>
<li><p><strong>Window (optional)</strong>: The period of time during which you want to listen for the trigger. Examples: 9am to 12pm and 4pm - 11pm.</p></li>
<li><p><strong>Cooldown (optional)</strong>: The amount of time to wait before the same trigger can fire again. Examples: 8 hours, 1 week.</p></li>
</ul>

<h1 id="triggers">Triggers</h1>

<p>Triggers define the conditions under which your app should be notified.  There are 3 categories of places that you can be notified about.  These categories are:</p>

<ul>
<li><a href="#place-of-interest">Place of Interest</a> - Examples are: Restaurant, Shopping Mall, etc.</li>
<li><a href="#personal-place">Personal Place</a> - Examples are: Home/Work.</li>
<li><a href="#custom-geofence">Custom Geofence</a> - These can be any latitude/longitude point with a radius.</li>
</ul>

<p>All triggers are built by the class FireTrigger.  Within there, you will find every function you need to get going.</p>

<aside class="notice"> IMPORTANT: A trigger on its own does nothing. You must build your triggers, and then add it to a Recipe in order to utilize the trigger. 
</aside>

<h2 id="place-of-interest">Place of Interest</h2>

<p>Gives you the ability to be notified when a user enters or exits a particular POI type.</p>
<pre><code class="highlight swift"><span class="c1">// Will notify you when the user enters an Airport
</span><span class="k">let</span> <span class="nv">airportTrigger</span><span class="p">:</span> <span class="kt">Trigger</span><span class="p">?</span> <span class="o">=</span> <span class="kt">FireTrigger</span><span class="o">.</span><span class="nf">whenEntersPoi</span><span class="p">(</span><span class="o">.</span><span class="kt">Airport</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="c1">// Will notify you when the user enters an Airport
</span><span class="n">Trigger</span> <span class="o">*</span><span class="n">restaurantTrigger</span> <span class="o">=</span> <span class="p">[</span><span class="n">FireTrigger</span> <span class="nf">whenEntersPoi</span><span class="p">:</span><span class="n">PoiTypeRestaurant</span> <span class="nf">conditions</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>

<p>Supported POI types:</p>

<table><thead>
<tr>
<th>Category</th>
<th>Transitions</th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Airport</td>
<td>.whenEntersPoi(.Airport)</td>
<td>.whenExitsPoi(.Airport)</td>
</tr>
<tr>
<td>Bar</td>
<td>.whenEntersPoi(.Bar)</td>
<td>.whenExitsPoi(.Bar)</td>
</tr>
<tr>
<td>Restaurant</td>
<td>.whenEntersPoi(.Restaurant)</td>
<td>.whenExitsPoi(.Restaurant)</td>
</tr>
<tr>
<td>Mall</td>
<td>.whenEntersPoi(.Mall)</td>
<td>.whenExitsPoi(.Mall)</td>
</tr>
<tr>
<td>Cafe</td>
<td>.whenEntersPoi(.Cafe)</td>
<td>.whenExitsPoi(.Cafe)</td>
</tr>
<tr>
<td>Gym</td>
<td>.whenEntersPoi(.Gym)</td>
<td>.whenExitsPoi(.Gym)</td>
</tr>
</tbody></table>

<h3 id="caveats">Caveats</h3>

<ul>
<li>Each trigger can only detect a single POI type.</li>
<li>The sdk will not trigger immediately on entrance or exit because it needs to be sure of the user&rsquo;s presence.</li>
</ul>

<h2 id="personal-place">Personal Place</h2>

<p>Gives you the ability to be notified when a user enters or exits their home or work. You can also be notified if the user is far awar from their home or work.</p>
<pre><code class="highlight swift"><span class="c1">// Will notify you when the user enters their Home
</span><span class="k">let</span> <span class="nv">homeTrigger</span><span class="p">:</span> <span class="kt">Trigger</span><span class="p">?</span> <span class="o">=</span> <span class="kt">FireTrigger</span><span class="o">.</span><span class="nf">whenEntersPersonalizedPlace</span><span class="p">(</span><span class="o">.</span><span class="kt">Home</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="c1">// Will notify you when the user enters their Home
</span><span class="n">Trigger</span> <span class="o">*</span><span class="n">homeTrigger</span> <span class="o">=</span> <span class="p">[</span><span class="n">FireTrigger</span> <span class="nf">whenEntersPersonalizedPlace</span><span class="p">:</span><span class="n">PersonalizedPlaceTypeHome</span> <span class="nf">conditions</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>

<p>The currently supported personalized location categories are:</p>

<table><thead>
<tr>
<th>Category</th>
<th>Transitions</th>
<th></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Home</td>
<td>.whenEntersPersonalizedPlace(.Home)</td>
<td>.whenExitsPersonalizedPlace(.Home)</td>
<td>whenExitsPersonalizedPlace(.Home, kilometers: 10)</td>
</tr>
<tr>
<td>Work</td>
<td>.whenEntersPersonalizedPlace(.Work)</td>
<td>.whenExitsPersonalizedPlace(.Work)</td>
<td>whenExitsPersonalizedPlace(.Work, kilometers: 10)</td>
</tr>
</tbody></table>

<h3 id="caveats">Caveats</h3>

<ul>
<li>The SDK takes roughly a week to determine a user&rsquo;s home or work. After the SDK identifies the users home or work, it can then start detecting the users presence there.</li>
<li>The SDK will continually try to update the user&rsquo;s home every few days.</li>
<li>Due to the sensitivity of this data, neither developers nor us will ever see the raw data or store a users home or office location. The computation happens on the device itself and stays there to ensure your users privacy.</li>
<li>The sdk will not trigger immediately on entrance or exit because it needs to be sure of the user&rsquo;s presence.</li>
</ul>

<h2 id="custom-geofence">Custom Geofence</h2>

<p>A custom geofence allows you specify a region to monitor for entrance and exit. This geofence will only be registered for this user (not your entire application).</p>
<pre><code class="highlight swift"><span class="k">let</span> <span class="nv">hq</span> <span class="o">=</span> <span class="kt">CustomGeofence</span><span class="p">(</span><span class="nv">latitude</span><span class="p">:</span> <span class="mf">37.124</span><span class="p">,</span> <span class="nv">longitude</span><span class="p">:</span> <span class="o">-</span><span class="mf">127.456</span><span class="p">,</span> <span class="nv">radius</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nv">customIdentifier</span><span class="p">:</span> <span class="s">"Sense 360 Headquarters"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">lunchSpot</span> <span class="o">=</span> <span class="kt">CustomGeofence</span><span class="p">(</span><span class="nv">latitude</span><span class="p">:</span> <span class="mf">37.124</span><span class="p">,</span> <span class="nv">longitude</span><span class="p">:</span> <span class="o">-</span><span class="mf">127.456</span><span class="p">,</span> <span class="nv">radius</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nv">customIdentifier</span><span class="p">:</span> <span class="s">"A&amp;B Bar and Grill"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">geofenceTrigger</span><span class="p">:</span> <span class="kt">Trigger</span><span class="p">?</span> <span class="o">=</span> <span class="kt">FireTrigger</span><span class="o">.</span><span class="nf">whenEntersGeofences</span><span class="p">([</span><span class="n">hq</span><span class="p">,</span> <span class="n">lunchSpot</span><span class="p">])</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="n">CustomGeofence</span> <span class="o">*</span><span class="n">hq</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CustomGeofence</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithLatitude</span><span class="p">:</span><span class="mi">37</span><span class="p">.</span><span class="mi">124</span> <span class="nf">longitude</span><span class="p">:</span><span class="o">-</span><span class="mi">127</span><span class="p">.</span><span class="mi">456</span> <span class="nf">radius</span><span class="p">:</span><span class="mi">50</span> <span class="nf">customIdentifier</span><span class="p">:</span><span class="s">@"Sense 360 Headquarters"</span><span class="p">];</span>
<span class="n">CustomGeofence</span> <span class="o">*</span><span class="n">lunchSpot</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CustomGeofence</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithLatitude</span><span class="p">:</span><span class="mi">37</span><span class="p">.</span><span class="mi">124</span> <span class="nf">longitude</span><span class="p">:</span><span class="o">-</span><span class="mi">127</span><span class="p">.</span><span class="mi">456</span> <span class="nf">radius</span><span class="p">:</span><span class="mi">50</span> <span class="nf">customIdentifier</span><span class="p">:</span><span class="s">@"A&amp;B Bar and Grill"</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class="n">geofences</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSArray</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithObjects</span><span class="p">:</span><span class="n">hq</span><span class="p">,</span><span class="n">lunchSpot</span><span class="p">,</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">[</span><span class="n">FireTrigger</span> <span class="nf">whenEntersGeofences</span><span class="p">:</span> <span class="n">geofences</span> <span class="nf">conditions</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>

<p>All custom geofence triggers must specify the following parameters</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>location</td>
<td>Location</td>
<td>true</td>
<td>location</td>
</tr>
<tr>
<td>radius</td>
<td>Int</td>
<td>true</td>
<td>radius of geofence</td>
</tr>
<tr>
<td>customIdentifier</td>
<td>String</td>
<td>true</td>
<td>unique identifier for your geofence</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Type</th>
<th>Transitions</th>
<th></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>CustomGeofence</td>
<td>.whenEntersGeofences()</td>
<td>.whenExitsGeofences()</td>
<td>.whenExitsGeofences([CustomGeofence], kilometers: 10)</td>
</tr>
</tbody></table>

<h3 id="caveats">Caveats</h3>

<ul>
<li>You can specify at most 1000 geofences to monitor</li>
<li>Geofences must have a radius of at least 30m</li>
<li>The SDK will not trigger immediately on entrance or exit because it needs to be sure of the user&rsquo;s presence.</li>
</ul>

<h2 id="handling-trigger-creation-errors">Handling Trigger Creation Errors</h2>
<pre><code class="highlight swift"><span class="k">let</span> <span class="nv">errorPointer</span> <span class="o">=</span> <span class="kt">SenseSdkErrorPointer</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="kt">FireTrigger</span><span class="o">.</span><span class="nf">whenEntersPoi</span><span class="p">(</span><span class="o">.</span><span class="kt">Airport</span><span class="p">,</span> <span class="nv">errorPtr</span><span class="p">:</span> <span class="n">errorPointer</span><span class="p">)</span>
<span class="k">if</span> <span class="k">let</span> <span class="nv">airportTrigger</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">trigger</span> <span class="p">{</span>
  <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Success monitoring airport entrance!"</span><span class="p">)</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Error building airport trigger. Msg="</span> <span class="o">+</span> <span class="n">errorPointer</span><span class="o">.</span><span class="n">error</span><span class="o">!.</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="n">SenseSdkErrorPointer</span> <span class="o">*</span><span class="n">errorPtr</span> <span class="o">=</span> <span class="p">[</span><span class="n">SenseSdkErrorPointer</span> <span class="nf">create</span><span class="p">];</span>
<span class="n">Trigger</span> <span class="o">*</span><span class="n">restaurantTrigger</span> <span class="o">=</span> <span class="p">[</span><span class="n">FireTrigger</span> <span class="nf">whenEntersPoi</span><span class="p">:</span><span class="n">PoiTypeRestaurant</span> <span class="nf">conditions</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="n">errorPtr</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="n">restaurantTrigger</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Success monitoring airport entrance!"</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">errorPtr</span><span class="p">.</span><span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p>In the event that there is an error when setting up a trigger, a nil will be returned with the error message stored within the corresponding SenseSdkErrorPointer.</p>

<h1 id="recipes">Recipes</h1>

<p>The Recipe is the container that encases your trigger, and various other settings.  Recipes are registered globally within your application with a call to the <a href="#sensesdk">SenseSdk</a>.  Below are the inputs that make up a Recipe:</p>
<pre><code class="highlight swift"><span class="c1">// Basic trigger. No time restriction. No cooldown. (can fire at most every minute)
</span><span class="k">let</span> <span class="nv">recipe</span> <span class="o">=</span> <span class="kt">Recipe</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"My Recipe"</span><span class="p">,</span> <span class="nv">trigger</span><span class="p">:</span> <span class="n">someTrigger</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="n">Recipe</span> <span class="o">*</span><span class="n">recipe</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Recipe</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithName</span><span class="p">:</span> <span class="s">@"My Recipe"</span> 
                                      <span class="nf">trigger</span><span class="p">:</span> <span class="n">someTrigger</span>
                                   <span class="nf">timeWindow</span><span class="p">:</span> <span class="p">[</span><span class="n">TimeWindow</span> <span class="nf">allDay</span><span class="p">]</span>
                                     <span class="nf">cooldown</span><span class="p">:</span> <span class="p">[</span><span class="n">Cooldown</span> <span class="nf">defaultCooldown</span><span class="p">]];</span>
</code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>uniqueId (String)</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td><a href="#triggers">trigger</a></td>
<td>true</td>
<td></td>
</tr>
<tr>
<td><a href="#window">window</a></td>
<td>false</td>
<td>0-23 hours</td>
</tr>
<tr>
<td><a href="#cooldown">cool down</a></td>
<td>false</td>
<td>5 minutes</td>
</tr>
</tbody></table>

<h2 id="time-window">Time Window</h2>

<p>A time window specifies which hours of the day a trigger is allowed to fire.</p>
<pre><code class="highlight swift"><span class="c1">// This will only allow a trigger to fire between the hours of 5pm and 10pm (in the users local time)
</span><span class="k">let</span> <span class="nv">recipe</span> <span class="o">=</span> <span class="kt">Recipe</span><span class="p">(</span>
  <span class="nv">name</span><span class="p">:</span> <span class="s">"My Recipe"</span><span class="p">,</span> 
  <span class="nv">trigger</span><span class="p">:</span> <span class="n">someTrigger</span><span class="p">,</span>
  <span class="nv">window</span><span class="p">:</span> <span class="kt">TimeWindow</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="nv">fromHour</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="nv">toHour</span><span class="p">:</span> <span class="mi">22</span><span class="p">))</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="n">Recipe</span> <span class="o">*</span><span class="n">recipe</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Recipe</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithName</span><span class="p">:</span> <span class="s">@"My Recipe"</span>
                                      <span class="nf">trigger</span><span class="p">:</span> <span class="n">someTrigger</span>
                                   <span class="nf">timeWindow</span><span class="p">:</span> <span class="p">[</span><span class="n">TimeWindow</span> <span class="nf">createFromHour</span><span class="p">:</span><span class="mi">17</span> <span class="nf">toHour</span><span class="p">:</span><span class="mi">22</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">]</span>
                                     <span class="nf">cooldown</span><span class="p">:</span> <span class="p">[</span><span class="n">Cooldown</span> <span class="nf">defaultCooldown</span><span class="p">]];</span>

</code></pre>

<h4 id="params">Params</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Range</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>fromHour</td>
<td>Int</td>
<td>0-23</td>
<td>true</td>
<td>Window start time (user&rsquo;s local time)</td>
</tr>
<tr>
<td>toHour</td>
<td>Int</td>
<td>0-23</td>
<td>true</td>
<td>Window end time (user&rsquo;s local time)</td>
</tr>
</tbody></table>

<h3 id="values">Values</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>allDay</td>
<td>No time restriction on firing</td>
</tr>
</tbody></table>

<h3 id="caveats">Caveats</h3>

<ul>
<li>The transition must occur between the times specified. For example, if a user enters at 5am, and the window was set for 6am - 7am, the trigger WILL NOT fire, even if the user is still within the specified geofence at 6am.</li>
</ul>

<h2 id="cooldown">Cooldown</h2>

<p>The amount of time after a trigger fires, to wait before the same trigger can fire again.</p>
<pre><code class="highlight swift"><span class="c1">// Wait 2 days after the trigger fires
</span><span class="k">let</span> <span class="nv">recipe</span> <span class="o">=</span> <span class="kt">Recipe</span><span class="p">(</span>
  <span class="nv">name</span><span class="p">:</span> <span class="s">"My Recipe"</span><span class="p">,</span> 
  <span class="nv">trigger</span><span class="p">:</span> <span class="n">someTrigger</span><span class="p">,</span> 
  <span class="nv">cooldown</span><span class="p">:</span> <span class="kt">Cooldown</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="nv">oncePer</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nv">frequency</span><span class="p">:</span> <span class="o">.</span><span class="kt">Days</span><span class="p">)</span><span class="o">!</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="c1">// Wait 2 days after the trigger fires
</span><span class="n">Recipe</span> <span class="o">*</span><span class="n">recipe</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Recipe</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithName</span><span class="p">:</span> <span class="s">@"My Recipe"</span>
                                      <span class="nf">trigger</span><span class="p">:</span> <span class="n">someTrigger</span>
                                   <span class="nf">timeWindow</span><span class="p">:</span> <span class="p">[</span><span class="n">TimeWindow</span> <span class="nf">allDay</span><span class="p">]</span>
                                     <span class="nf">cooldown</span><span class="p">:</span> <span class="p">[</span><span class="n">Cooldown</span> <span class="nf">createWithOncePer</span><span class="p">:</span><span class="mi">2</span> <span class="nf">frequency</span><span class="p">:</span><span class="n">CooldownTimeUnitDays</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">]];</span>
</code></pre>

<h3 id="values">Values</h3>

<table><thead>
<tr>
<th>Unit</th>
<th>Signature</th>
</tr>
</thead><tbody>
<tr>
<td>Minutes</td>
<td>Cooldown.create(oncePer: 5, frequency: .Minutes)!</td>
</tr>
<tr>
<td>Hours</td>
<td>Cooldown.create(oncePer: 5, frequency: .Hours)!</td>
</tr>
<tr>
<td>Days</td>
<td>Cooldown.create(oncePer: 5, frequency: .Days)!</td>
</tr>
<tr>
<td>Default</td>
<td>Cooldown.create(oncePer: 30, frequency: .Minutes)!</td>
</tr>
</tbody></table>

<h3 id="caveats">Caveats</h3>

<ul>
<li>The minimum cooldown time is 5 minutes.</li>
</ul>

<h1 id="sensesdk">SenseSdk</h1>

<p>The SenseSdk is the main entry point into the Sdk. It allows you to register and unregister recipes.</p>

<aside class="warning"> You must call enableSdkWithKey in your AppDelegate&rsquo;s applicationDidFinishLaunching method.
</aside>
<pre><code class="highlight swift"><span class="c1">// Registering a recipe and delegate
</span><span class="k">let</span> <span class="nv">success</span> <span class="o">=</span> <span class="kt">SenseSdk</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="nv">recipe</span><span class="p">:</span> <span class="n">restaurantRecipe</span><span class="p">,</span> <span class="nv">delegate</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">errorPtr</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="c1">// Registering a recipe and delegate
</span><span class="n">Boolean</span> <span class="n">success</span> <span class="o">=</span> <span class="p">[</span><span class="n">SenseSdk</span> <span class="nf">registerWithRecipe</span><span class="p">:</span><span class="n">recipe</span> <span class="nf">delegate</span><span class="p">:</span><span class="n">callback</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>

<table><thead>
<tr>
<th>Function</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>enableSdkWithKey</td>
<td>String</td>
<td>Enable the SDK with your application key (provided by Sense360)</td>
</tr>
<tr>
<td>register</td>
<td><a href="#recipes">Recipe</a>, <a href="#recipefireddelegate">RecipeFiredDelegate</a>, <a href="#sensesdkerrorpointer">SenseSdkErrorPointer</a></td>
<td>Starts the recipe and registers the delegate to be called when the trigger fires.</td>
</tr>
<tr>
<td>unregister</td>
<td>String</td>
<td>Stops and removes the recipe from SenseSdk by name.</td>
</tr>
<tr>
<td>findRecipe</td>
<td>String</td>
<td>Finds and returns a recipe by name.</td>
</tr>
</tbody></table>

<aside class="notice"> Your application key will be validated regulary every few days.
</aside>

<h2 id="sensesdkerrorpointer">SenseSdkErrorPointer</h2>

<p>This class is used to communicate any errors on a registration of a recipe with the <a href="#sensesdk">SenseSdk</a>.</p>

<table><thead>
<tr>
<th>Containing Class</th>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SenseSdkError</td>
<td>message</td>
<td>The error message</td>
</tr>
</tbody></table>

<h1 id="after-a-trigger-fires">After a trigger fires</h1>

<p>Acting on triggers is done by implementing the RecipeFiredDelegate protocol. In order to implement the protocol, you must define the recipeFired method, which has one parameter of type RecipeFiredArgs. </p>

<p>The RecipeFiredArgs contains trigger-specific information which is passed through an array of TriggerFiredArgs. </p>
<pre><code class="highlight swift"><span class="kd">class</span> <span class="kt">MyCallback</span> <span class="p">:</span> <span class="kt">RecipeFiredDelegate</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">recipeFired</span><span class="p">(</span><span class="nv">args</span><span class="p">:</span> <span class="kt">RecipeFiredArgs</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Recipe </span><span class="se">\(</span><span class="n">args</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s"> fired at </span><span class="se">\(</span><span class="n">args</span><span class="o">.</span><span class="n">timestamp</span><span class="se">)</span><span class="s">."</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">trigger</span> <span class="k">in</span> <span class="n">args</span><span class="o">.</span><span class="n">triggersFired</span> <span class="p">{</span>
          <span class="k">for</span> <span class="n">place</span> <span class="k">in</span> <span class="n">trigger</span><span class="o">.</span><span class="n">places</span> <span class="p">{</span>
              <span class="kt">NSLog</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="k">@interface</span> <span class="nc">MyCallback</span> <span class="p">:</span> <span class="nc">NSObject</span><span class="o">&lt;</span><span class="n">RecipeFiredDelegate</span><span class="o">&gt;</span>

<span class="k">@implementation</span> <span class="nc">MyCallback</span> <span class="p">{</span>
  <span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">recipeFired</span><span class="o">:</span><span class="p">(</span><span class="n">RecipeFiredArgs</span><span class="o">*</span><span class="p">)</span> <span class="n">args</span> <span class="p">{</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Recipe %@ fired at %@."</span><span class="p">,</span> <span class="p">[[</span><span class="n">args</span> <span class="nf">recipe</span><span class="p">]</span> <span class="nf">name</span><span class="p">],</span> <span class="p">[</span><span class="n">args</span> <span class="nf">timestamp</span><span class="p">]);</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">TriggerFiredArgs</span><span class="o">*</span> <span class="n">trigger</span> <span class="k">in</span> <span class="p">[</span><span class="n">args</span> <span class="nf">triggersFired</span><span class="p">])</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">NSObject</span> <span class="o">&lt;</span><span class="n">NSCoding</span><span class="p">,</span> <span class="n">Place</span><span class="o">&gt;*</span> <span class="n">place</span> <span class="k">in</span> <span class="p">[</span><span class="n">trigger</span> <span class="nf">places</span><span class="p">])</span> <span class="p">{</span>
              <span class="n">NSLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="p">[</span><span class="n">place</span> <span class="nf">description</span><span class="p">]);</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<aside class="warning"> When we call your recipe delegate method, your code will have 10 seconds to run before iOS will shutdown the app
</aside>

<h2 id="recipefiredargs">RecipeFiredArgs</h2>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>timestamp</td>
<td>NSDate</td>
<td>The time at which the recipe was fired</td>
</tr>
<tr>
<td>recipe</td>
<td><a href="#recipes">Recipe</a></td>
<td>The recipe itself</td>
</tr>
<tr>
<td>triggersFired</td>
<td>[<a href="#triggerfiredargs">TriggerFiredArgs</a>]</td>
<td>The pertinent infromation on the triggers that fired. Will hold a single value per trigger.</td>
</tr>
<tr>
<td>confidenceLevel</td>
<td><a href="#confidence-levels">ConfidenceLevel</a></td>
<td>The combined confidence levels of all triggers within the recipe</td>
</tr>
</tbody></table>

<h2 id="triggerfiredargs">TriggerFiredArgs</h2>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>timestamp</td>
<td>NSDate</td>
<td>The time at which this trigger fired</td>
</tr>
<tr>
<td>places</td>
<td>[<a href="#places">Place</a>]</td>
<td>The places that caused this trigger to fired</td>
</tr>
<tr>
<td>confidenceLevel</td>
<td><a href="#confidence-levels">ConfidenceLevel</a></td>
<td>The confidence that the corresponding action actually occurred</td>
</tr>
</tbody></table>

<h2 id="places">Places</h2>

<h3 id="customgeofence">CustomGeofence</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customIdentifier</td>
<td>String</td>
<td>A unique string which identifies the custom geofence (provided by you)</td>
</tr>
<tr>
<td>location</td>
<td>Location</td>
<td>The latitude and longitude of the center</td>
</tr>
<tr>
<td>radius</td>
<td>Double</td>
<td>The radius of the geofence</td>
</tr>
</tbody></table>
<pre><code class="highlight swift"><span class="kd">func</span> <span class="nf">recipeFired</span><span class="p">(</span><span class="nv">args</span><span class="p">:</span> <span class="kt">RecipeFiredArgs</span><span class="p">)</span> <span class="p">{</span>

        <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Recipe </span><span class="se">\(</span><span class="n">args</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s"> fired at </span><span class="se">\(</span><span class="n">args</span><span class="o">.</span><span class="n">timestamp</span><span class="se">)</span><span class="s">. "</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">triggersFired</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">triggerFired</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">triggersFired</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">triggerFired</span><span class="o">.</span><span class="n">places</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
                <span class="k">let</span> <span class="nv">place</span> <span class="o">=</span> <span class="n">triggerFired</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">let</span> <span class="nv">transitionDesc</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">trigger</span><span class="o">.</span><span class="n">transitionType</span><span class="o">.</span><span class="n">description</span>
                <span class="k">switch</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="o">.</span><span class="kt">CustomGeofence</span><span class="p">:</span>
                        <span class="k">if</span> <span class="k">let</span> <span class="nv">geofence</span> <span class="o">=</span> <span class="n">place</span> <span class="k">as</span><span class="p">?</span> <span class="kt">CustomGeofence</span> <span class="p">{</span>
                            <span class="kt">NSLog</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">transitionDesc</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">geofence</span><span class="o">.</span><span class="n">customIdentifier</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                        <span class="p">}</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="o">.</span><span class="kt">Personal</span><span class="p">:</span>
                        <span class="k">if</span> <span class="k">let</span> <span class="nv">personal</span> <span class="o">=</span> <span class="n">place</span> <span class="k">as</span><span class="p">?</span> <span class="kt">PersonalizedPlace</span> <span class="p">{</span>
                            <span class="kt">NSLog</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">transitionDesc</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">personal</span><span class="o">.</span><span class="n">personalizedPlaceType</span><span class="o">.</span><span class="n">description</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                        <span class="p">}</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="o">.</span><span class="kt">Poi</span><span class="p">:</span>
                        <span class="k">if</span> <span class="k">let</span> <span class="nv">poi</span> <span class="o">=</span> <span class="n">place</span> <span class="k">as</span><span class="p">?</span> <span class="kt">PoiPlace</span> <span class="p">{</span>
                            <span class="kt">NSLog</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">transitionDesc</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">poi</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">description</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                        <span class="p">}</span>
                        <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">recipeFired</span><span class="p">:(</span><span class="n">RecipeFiredArgs</span><span class="o">*</span><span class="p">)</span> <span class="n">args</span> <span class="p">{</span>
    <span class="c1">//Your user has entered a restaurant!//
</span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Recipe %@ fired at %@."</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">recipe</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">timestamp</span><span class="p">);</span>

    <span class="n">NSString</span> <span class="o">*</span><span class="n">transitionDesc</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">recipe</span><span class="p">.</span><span class="n">trigger</span><span class="p">.</span><span class="n">transitionType</span> <span class="o">==</span> <span class="n">TransitionTypeEnter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">transitionDesc</span> <span class="o">=</span> <span class="s">@"Enter"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">transitionDesc</span> <span class="o">=</span> <span class="s">@"Exit"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">triggersFired</span><span class="p">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">TriggerFiredArgs</span> <span class="o">*</span><span class="n">trigger</span> <span class="o">=</span> <span class="p">(</span><span class="n">TriggerFiredArgs</span><span class="o">*</span><span class="p">)</span> <span class="n">args</span><span class="p">.</span><span class="n">triggersFired</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

        <span class="n">NSObject</span><span class="o">&lt;</span><span class="n">NSCoding</span><span class="p">,</span> <span class="n">Place</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">place</span> <span class="o">=</span> <span class="p">(</span><span class="n">NSObject</span><span class="o">&lt;</span><span class="n">NSCoding</span><span class="p">,</span> <span class="n">Place</span><span class="o">&gt;*</span><span class="p">)</span><span class="n">trigger</span><span class="p">.</span><span class="n">places</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

        <span class="k">if</span><span class="p">(</span><span class="n">place</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PlaceTypeCustomGeofence</span><span class="p">)</span> <span class="p">{</span>

            <span class="n">CustomGeofence</span> <span class="o">*</span><span class="n">geofence</span> <span class="o">=</span> <span class="p">(</span><span class="n">CustomGeofence</span><span class="o">*</span><span class="p">)</span><span class="n">place</span><span class="p">;</span>
            <span class="n">NSString</span> <span class="o">*</span><span class="n">notificationBody</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFormat</span><span class="p">:</span> <span class="s">@"%@ %@"</span><span class="p">,</span> <span class="n">transitionDesc</span><span class="p">,</span> <span class="n">geofence</span><span class="p">.</span><span class="n">customIdentifier</span><span class="p">];</span>
            <span class="p">[</span><span class="n">NotificationSender</span> <span class="nf">send</span><span class="p">:</span><span class="n">notificationBody</span><span class="p">];</span>

        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">place</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PlaceTypePersonal</span><span class="p">)</span> <span class="p">{</span>

            <span class="n">PersonalizedPlace</span> <span class="o">*</span><span class="n">personalizedPlace</span> <span class="o">=</span> <span class="p">(</span><span class="n">PersonalizedPlace</span><span class="o">*</span><span class="p">)</span><span class="n">place</span><span class="p">;</span>
            <span class="n">NSString</span> <span class="o">*</span><span class="n">personalizedPlaceType</span> <span class="o">=</span> <span class="p">[</span><span class="n">PersonalizedPlace</span> <span class="nf">getDescriptionOfPersonalizedPlaceType</span><span class="p">:(</span><span class="kt">int</span><span class="p">)</span><span class="n">personalizedPlace</span><span class="p">.</span><span class="n">type</span><span class="p">];</span>
            <span class="n">NSString</span> <span class="o">*</span><span class="n">notificationBody</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFormat</span><span class="p">:</span> <span class="s">@"%@ %@"</span><span class="p">,</span> <span class="n">transitionDesc</span><span class="p">,</span><span class="n">personalizedPlaceType</span><span class="p">];</span>
            <span class="p">[</span><span class="n">NotificationSender</span> <span class="nf">send</span><span class="p">:</span><span class="n">notificationBody</span><span class="p">];</span>

        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">place</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PlaceTypePoi</span><span class="p">)</span> <span class="p">{</span>

            <span class="n">PoiPlace</span> <span class="o">*</span><span class="n">poiPlace</span> <span class="o">=</span> <span class="p">(</span><span class="n">PoiPlace</span><span class="o">*</span><span class="p">)</span><span class="n">place</span><span class="p">;</span>
            <span class="n">NSString</span> <span class="o">*</span><span class="n">notificationBody</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFormat</span><span class="p">:</span> <span class="s">@"%@ %@"</span><span class="p">,</span> <span class="n">transitionDesc</span><span class="p">,</span> <span class="n">poiPlace</span><span class="p">.</span><span class="n">description</span><span class="p">];</span>
            <span class="p">[</span><span class="n">NotificationSender</span> <span class="nf">send</span><span class="p">:</span><span class="n">notificationBody</span><span class="p">];</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>

<h3 id="poiplace">PoiPlace</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>String</td>
<td>A unique string which identifies the place (provided by us)</td>
</tr>
<tr>
<td>location</td>
<td>Location</td>
<td>The latitude and longitude of the center</td>
</tr>
<tr>
<td>radius</td>
<td>Double</td>
<td>The radius of the geofence</td>
</tr>
<tr>
<td>types</td>
<td>[<a href="#poitype">PoiType</a>]</td>
<td>The category of the place</td>
</tr>
</tbody></table>

<h4 id="poitype">PoiType</h4>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Airport</td>
</tr>
<tr>
<td>Bar</td>
</tr>
<tr>
<td>Restaurant</td>
</tr>
<tr>
<td>Mall</td>
</tr>
<tr>
<td>Cafe</td>
</tr>
<tr>
<td>Gym</td>
</tr>
</tbody></table>

<h3 id="personalizedplace">PersonalizedPlace</h3>

<table><thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>location</td>
<td>Location</td>
<td>The latitude and longitude of the center</td>
</tr>
<tr>
<td>radius</td>
<td>Double</td>
<td>The radius of the geofence</td>
</tr>
<tr>
<td>personalizedPlaceType</td>
<td><a href="#personalizedplacetype">PersonalizedPlaceType</a></td>
<td>The type of place</td>
</tr>
</tbody></table>

<h4 id="personalizedplacetype">PersonalizedPlaceType</h4>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Home</td>
</tr>
<tr>
<td>Work</td>
</tr>
</tbody></table>

<h2 id="confidence-levels">Confidence Levels</h2>

<p>When a trigger is fired, it brings along one of three confidence levels.</p>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>High</td>
</tr>
<tr>
<td>Medium</td>
</tr>
<tr>
<td>Low</td>
</tr>
</tbody></table>

<h1 id="conditional-elements">Conditional Elements</h1>

<p>A trigger is often just one half of the puzzle.  Your specific case may require a trigger to fire only when your user satisfies some other criteria, like how far they are from their home.  A conditional element allows you to do just that.</p>

<p>Several conditions may be applied when creating any type of trigger through the FireTrigger class.  All conditions applied to a trigger MUST be satisfied in order for the entire recipe to fire.</p>

<aside class="notice"> The only conditional element supported as of today is fartherThan, but closerThan and many more will be coming soon.
</aside>
<pre><code class="highlight swift"><span class="kt">FireTrigger</span><span class="o">.</span><span class="nf">whenEntersPoi</span><span class="p">(</span><span class="o">.</span><span class="kt">Airport</span><span class="p">,</span> <span class="nv">conditions</span><span class="p">:</span> <span class="n">conditions</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="p">[</span><span class="n">FireTrigger</span> <span class="nf">whenEntersPoi</span><span class="p">:</span><span class="n">PoiTypeAirport</span> <span class="nf">conditions</span><span class="p">:</span><span class="n">conditions</span> <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>

<h2 id="farther-than-condition">Farther Than Condition</h2>

<p>The farther than condition ensures that the trigger will only fire if the user is farther than X kilometers from either a personalized place or a list of custom geofences.</p>

<p>One use could be that you your app should suggest a hotel to stay at when your user enters an airport and is farther than 150 kilometers from their home.</p>

<h3 id="caveats:">Caveats:</h3>

<ul>
<li>If you specify multiple geofences within a single condition, the user must be farther than ALL of the locations in order to trigger the callback.</li>
<li>If you need to create a fartherThan condition where user only needs to be [x] distance from one of multiple locations, you will need to create an individual Recipe PLUS Conditional Element per geofence.</li>
</ul>

<aside class="warning"> Note: you cannot use the fartherThan condition with POI Place Types.
</aside>
<pre><code class="highlight swift"><span class="k">let</span> <span class="nv">condition</span> <span class="o">=</span> <span class="kt">UsersLocation</span><span class="o">.</span><span class="nf">isFartherThanPersonalizedPlace</span><span class="p">(</span><span class="o">.</span><span class="kt">Home</span><span class="p">,</span> <span class="nv">kilometers</span><span class="p">:</span> <span class="mi">150</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="n">ConditionalElement</span><span class="o">*</span> <span class="n">condition</span> <span class="o">=</span> <span class="p">[</span><span class="n">UsersLocation</span> 
                     <span class="nf">isFartherThanPersonalizedPlace</span><span class="p">:</span><span class="n">PersonalizedPlaceTypeHome</span>
                                         <span class="nf">kilometers</span><span class="p">:[</span><span class="n">NSNumber</span> <span class="nf">numberWithInt</span><span class="p">:</span><span class="mi">150</span><span class="p">]</span>
                                           <span class="nf">errorPtr</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre>

<h1 id="testing">Testing</h1>

<p>Testing in the real world is time consuming, so we provide a way to easily trigger your Recipe to fire.</p>
<pre><code class="highlight swift"><span class="c1">//Create a fake restaurant
</span><span class="k">let</span> <span class="nv">place</span> <span class="o">=</span> <span class="kt">PoiPlace</span><span class="p">(</span><span class="nv">latitude</span><span class="p">:</span> <span class="mf">34.111</span><span class="p">,</span> <span class="nv">longitude</span><span class="p">:</span> <span class="o">-</span><span class="mf">118.111</span><span class="p">,</span> <span class="nv">radius</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Big Restaurant"</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="s">"id1"</span><span class="p">,</span> <span class="nv">types</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="kt">Restaurant</span><span class="p">])</span>

<span class="k">let</span> <span class="nv">errorPointer</span> <span class="o">=</span> <span class="kt">SenseSdkErrorPointer</span><span class="o">.</span><span class="nf">create</span><span class="p">()</span>
<span class="c1">// This method should only be used for testing
</span><span class="kt">SenseSdkTestUtility</span><span class="o">.</span><span class="nf">fireTrigger</span><span class="p">(</span>
    <span class="nv">fromRecipe</span><span class="p">:</span> <span class="s">"ArrivedAtRestaurant"</span><span class="p">,</span>
    <span class="nv">confidenceLevel</span><span class="p">:</span> <span class="kt">ConfidenceLevel</span><span class="o">.</span><span class="kt">Medium</span><span class="p">,</span>
    <span class="nv">places</span><span class="p">:</span> <span class="p">[</span><span class="n">place</span><span class="p">],</span>
    <span class="nv">errorPtr</span><span class="p">:</span> <span class="n">errorPointer</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">errorPointer</span><span class="o">.</span><span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="kt">NSLog</span><span class="p">(</span><span class="s">"Error sending trigger"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<pre><code class="highlight objective_c"><span class="c1">//Create a fake restaurant
</span><span class="n">PoiPlace</span><span class="o">*</span> <span class="n">poiPlace</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PoiPlace</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithLatitude</span><span class="p">:</span><span class="mi">34</span><span class="p">.</span><span class="mi">111</span>
                         <span class="nf">longitude</span><span class="p">:</span><span class="o">-</span><span class="mi">118</span><span class="p">.</span><span class="mi">111</span>
                            <span class="nf">radius</span><span class="p">:</span><span class="mi">50</span>
                              <span class="nf">name</span><span class="p">:</span><span class="s">@"Big Restaurant"</span>
                                <span class="nf">id</span><span class="p">:</span><span class="s">@"id1"</span>
                              <span class="nf">type</span><span class="p">:</span> <span class="n">PoiTypeRestaurant</span><span class="p">];</span>
<span class="n">SenseSdkErrorPointer</span><span class="o">*</span> <span class="n">errorPtr</span> <span class="o">=</span> <span class="p">[</span><span class="n">SenseSdkErrorPointer</span> <span class="nf">create</span><span class="p">];</span>

<span class="c1">// This method should only be used for testing
</span><span class="n">NSArray</span><span class="o">*</span> <span class="n">places</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSArray</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithObjects</span><span class="p">:</span><span class="n">poiPlace</span><span class="p">,</span> <span class="nb">nil</span><span class="p">];</span>
<span class="p">[</span><span class="n">SenseSdkTestUtility</span> <span class="nf">fireTriggerFromRecipe</span><span class="p">:</span><span class="s">@"ArrivedAtRestaurant"</span>
                           <span class="nf">confidenceLevel</span><span class="p">:</span><span class="n">ConfidenceLevelMedium</span>
                                    <span class="nf">places</span><span class="p">:</span><span class="n">places</span>
                                  <span class="nf">errorPtr</span><span class="p">:</span><span class="n">errorPtr</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="n">errorPtr</span><span class="p">.</span><span class="n">error</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">NotificationSender</span> <span class="nf">send</span><span class="p">:</span><span class="s">@"Error sending trigger"</span><span class="p">];</span>
<span class="p">}</span>
</code></pre>

<h1 id="thanks-for-using-sense360">Thanks for using Sense360</h1>

<div style="height:120px;"></div>

        
    </div>
    <div class="dark-box">
    </div>
  </div>
</div>
</body>
</html>
